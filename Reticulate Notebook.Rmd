---
title: "Reticulate"
output: html_notebook
editor_options: 
  chunk_output_type: inline
---

# Import reticulate
First we'll import reticulate in an R code block:
```{r}
library(reticulate)
```

# Run Python code
We can immediately start playing with python within a code block designated as python:
```{python}
import pandas as pd

print('hello python')

some_dict = {'a':1, 'b':2, 'c':3}

print(some_dict.keys())
```

# Import Python modules
With reticulate, we can also import any Python module and call that module from R:
```{r}
os <- import("os")
os$listdir(".")
```

# REPL sessions
We can also start a Python REPL (read-eval-print shell) within our session by calling repl_python() at console (see console).  Notice the message I get when I start REPL on Python version being used
```{r}
# repl_python()
# below code at console
# import pandas as pd
# gages = pd.read_csv('https://raw.githubusercontent.com/mhweber/R-User-Group-Spatial-Workshop-2018/gh-pages/data/StreamGages.csv')
# gages.head()
# gages['STATE'].unique()
# PNW_gages = gages[gages['STATE'].isin(['OR','WA','ID'])]
# exit
```

# Access Python objects directly from R
Now work with the pandas data directly within R!
```{r}
library(sf)
library(ggplot2)

gages <- st_as_sf(py$PNW_gages,coords = c('LON_SITE','LAT_SITE'),crs = 4269) 
gages <- st_transform(gages, crs=5070) #5070 is Albers system in metres
ggplot(gages) + geom_sf()
```

# Access R objects from Python
Conversely, we can access our R objects within python chunks
```{python}
print(r.gages.head())
# list the column names
list(r.gages)
# what are all the values of STATE?
r.gages.STATE.unique()
```

# Python versions
You can use:
- Specific Python binaries you point to
- Python virtual environments
- Conda environments
```{r}
py_config()

```